---
title: "Examen_I_G2 - C33973  Cristhian Jimenez"
format: html
editor: visual
---

## 

```{r}
#install.packages("dplyr")
#install.packages("ggplot2")
#install.packages("tidyr")
#install.packages("readr")
#install.packages("rpart")
#install.packages("rpart.plot")

library(dplyr)
library(ggplot2)
library(tidyr)
library(readr)
library(rpart)
library(rpart.plot)

```

```{r}
#cargar datos
moras <- read_delim("moras.txt", delim = ",")
```

2.(r) Realice un resumen de 5 números incluyendo el promedio. Para las columnas numéricas
```{r}
Estadistica_EDAD <- moras %>% 
  summarise(
    EDAD_min = min(EDAD, na.rm = TRUE),
    EDAD_Q1 = quantile(moras$EDAD, 0.25, na.rm = TRUE),
    EDAD_mediana = median(EDAD, na.rm = TRUE),
    EDAD_Q3 = quantile(moras$EDAD, 0.75, na.rm = TRUE),
    EDAD_max = max(EDAD, na.rm = TRUE),
    SALARIO_media = mean(EDAD, na.rm = TRUE)
)
Estadistica_SALARIO <- moras %>% 
  summarise(
    SALARIO_min = min(SALARIO, na.rm = TRUE),
    SALARIO_Q1 = quantile(moras$SALARIO, 0.25, na.rm = TRUE),
    SALARIO_mediana = median(SALARIO, na.rm = TRUE),
    SALARIO_Q3 = quantile(moras$SALARIO, 0.75, na.rm = TRUE),
    SALARIO_max = max(SALARIO, na.rm = TRUE),
    SALARIO_media = mean(SALARIO, na.rm = TRUE),
)
Estadistica_EDAD
Estadistica_SALARIO
```

3.(r) Realice una columna donde se identifiquen valores atípicos haciendo uso del Z-Score, de tal manera que si el valor absoluto del Z-Score es mayor a 1,96 se considera un valor atípico. Esto para la columna de salario y edad.
```{r}
## Z-Score para salario
promedio_salario <- mean(moras$SALARIO, na.rm = TRUE)
desviacion_estandar_salario <- sd(moras$SALARIO, na.rm = TRUE)
Z_SALARIO <- (moras$SALARIO - promedio_salario) / desviacion_estandar_salario

promedio_EDAD <- mean(moras$EDAD, na.rm = TRUE)
desviacion_estandar_EDAD <- sd(moras$EDAD, na.rm = TRUE)
Z_EDAD <- (moras$EDAD - promedio_EDAD)/ desviacion_estandar_EDAD

moras$ATIPICO_SALARIO <- "Atípico" 
moras$ATIPICO_SALARIO[abs(Z_SALARIO) > 1.96] <- "Normal"

moras$ATIPICO_EDAD <- "Atípico"  
moras$ATIPICO_EDAD[abs(Z_EDAD) > 1.96] <- "Normal"
```

4.(r) Detecte el porcentaje de valores faltantes en cada una de las columnas.
```{r}
for (columna in names(moras)) {
  contar_na <- sum(is.na(moras[[columna]]))
  porcentaje <- round((contar_na / nrow(moras)) * 100, 2)
  cat("-", columna, ":", porcentaje, "% de NA\n")
  }
```

5.(r) Impute los valores faltantes haciendo uso de algún método de su preferencia.
```{r}
moras$EDAD[is.na(moras$EDAD)] <- mean(moras$EDAD, na.rm = TRUE)
moras$SALARIO[is.na(moras$SALARIO)] <- mean(moras$SALARIO, na.rm = TRUE)
moras$TIPO_ASEGURAMIENTO[is.na(moras$TIPO_ASEGURAMIENTO)] <- "DESCONOCIDO"
```

6.(r) Realice gráficos donde se vea la cantidad de individuos por cada categoría
```{r}
ggplot(moras, aes(x = SEXO)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por SEXO",
       x = "SEXO", 
       y = "Cantidad") +
  theme_minimal()
```
Se puede ver que nuestros datos tiene más hombres que mujeres					

```{r}
ggplot(moras, aes(x = SALARIO)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por SALARIO",
       x = "SALARIO", 
       y = "Cantidad") +
  theme_minimal()
```
Se puede ver que en algunos casos, los salario son bastantes grande en comparación con los demás, note que tiene un cero de más en cada columna, entonces para la comprensión solo se tiene que eliminar uno, no son 5 millones, sino 500 mil y así						

```{r}
ggplot(moras, aes(x = SECTOR)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por SECTOR",
       x = "SECTOR", 
       y = "Cantidad") +
  theme_minimal()
```
En esta se puede ver como hay más personas del sector privado que del público 					

```{r}
ggplot(moras, aes(x = INDICADOR_ACTIVO)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por INDICADOR_ACTIVO",
       x = "INDICADOR_ACTIVO", 
       y = "Cantidad") +
  theme_minimal()
```
Se puede ver como todos estan activos 				

```{r}
ggplot(moras, aes(x = INDICADOR_MOROSO)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por INDICADOR_ACTIVO",
       x = "INDICADOR_ACTIVO", 
       y = "Cantidad") +
  theme_minimal()
```
se puede ver que la mayoria de las personas si van pagando sus cuotas y que no son morosos pero que si hay morosidad				

```{r}
ggplot(moras, aes(x = EDAD)) +
  geom_bar(fill = "brown", color = "black") +
  labs(title = "Cantidad de Individuos por INDICADOR_ACTIVO",
       x = "SEXO", 
       y = "Cantidad") +
  theme_minimal()
```
Se puede ver como se distribuyo las edades de las personas y que la mayor cantida esta entre los 25 y los 45 	








